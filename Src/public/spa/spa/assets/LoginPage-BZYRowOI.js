import{Q as f,a as b,b as h}from"./QLayout-KX5b9nhp.js";import{_ as w,U as y,N as c,V as o,Q as t,Z as q,a7 as v,$ as i,M as x,W as _,O as m,X as p,a8 as u,a9 as k,R as g,a1 as Q,a3 as V}from"./index-C6gwNXbs.js";import{Q as C}from"./QForm-CFqleHfe.js";import{Q as B}from"./QPage-Bv0UVxaO.js";import"./QResizeObserver-BUyJuIK2.js";const S="/assets/logoB-CvLnfDSX.png",F={mounted(){this.$q.dark.set(!1)},name:"Login",data(){return{show:!1,loading:!1,logoFallback:!1,form:{username:"",password:"",remember:!0},errors:{username:!1,password:!1}}},methods:{tt(n,e){try{const r=this.$t?this.$t(n):"";return typeof r=="string"&&r!==n&&r.trim()?r:e}catch{return e}},validate(){return this.errors.username=!this.form.username,this.errors.password=!this.form.password,!(this.errors.username||this.errors.password)},async login(){if(!this.validate()){this.$q.notify({type:"warning",message:this.tt("login.errors.required","Completa los campos requeridos")});return}this.loading=!0;const n=V();try{const{data:e}=await this.$api.post("login",{username:this.form.username,email:this.form.username,password:this.form.password,remember:this.form.remember});n.setSession(e),this.$q.notify({type:"positive",message:`Bienvenido, ${e?.user?.name||this.form.username}`}),await this.$nextTick?.();const r=this.$route?.query?.redirect,d=typeof r=="string"&&r.trim()?r:{name:"home"};await this.$router.replace(d)}catch(e){const r=e?.response?.data?.message||e?.response?.data?.error||this.tt("login.errors.invalid","Credenciales inválidas");this.$q.notify({type:"negative",message:r})}finally{this.loading=!1}},onForgot(){this.$q.dialog({title:this.tt("login.forgot_title","Recuperar contraseña"),message:this.tt("login.forgot_msg","Contacte a la mesa de ayuda o utilice el portal de recuperación."),ok:this.tt("ok","Entendido")})}}},E={key:0,class:"text-h6 text-negative"},L={class:"row items-center justify-between q-mt-xs"};function N(n,e,r,d,s,a){return c(),y(h,{view:"lHh Lpr lFf"},{default:o(()=>[t(f,null,{default:o(()=>[t(B,{class:"bt-bg flex flex-center"},{default:o(()=>[t(q,{class:"bt-card q-pa-lg",bordered:""},{default:o(()=>[t(C,{onSubmit:v(a.login,["prevent"]),class:"q-gutter-md",ref:"formRef"},{default:o(()=>[t(i,{class:"text-center q-pt-sm q-pb-md"},{default:o(()=>[t(b,{src:S,alt:"Bantotal",class:"bt-logo",contain:"",onError:e[0]||(e[0]=l=>s.logoFallback=!0)}),s.logoFallback?(c(),x("div",E,"Bantotal")):_("",!0)]),_:1}),t(i,{class:"q-pt-none"},{default:o(()=>[t(p,{dense:"",standout:"bg-white","input-class":"text-black",class:"bt-input",modelValue:s.form.username,"onUpdate:modelValue":e[1]||(e[1]=l=>s.form.username=l),type:"text",autocomplete:"username",label:a.tt("login.user","Usuario"),error:s.errors.username,"error-message":a.tt("login.errors.required","Este campo es requerido")},{prepend:o(()=>[t(u,{name:"person"})]),_:1},8,["modelValue","label","error","error-message"]),t(p,{dense:"",standout:"bg-white","input-class":"text-black",class:"bt-input q-mt-sm",modelValue:s.form.password,"onUpdate:modelValue":e[3]||(e[3]=l=>s.form.password=l),type:s.show?"text":"password",autocomplete:"current-password",label:a.tt("login.pass","Contraseña"),error:s.errors.password,"error-message":a.tt("login.errors.required","Este campo es requerido")},{prepend:o(()=>[t(u,{name:"lock"})]),append:o(()=>[t(u,{name:s.show?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[2]||(e[2]=l=>s.show=!s.show),"aria-label":"Mostrar/ocultar contraseña",role:"button",tabindex:"0"},null,8,["name"])]),_:1},8,["modelValue","type","label","error","error-message"]),m("div",L,[t(k,{dense:"",modelValue:s.form.remember,"onUpdate:modelValue":e[4]||(e[4]=l=>s.form.remember=l),label:a.tt("login.remember","Recordarme"),color:"grey-8"},null,8,["modelValue","label"]),t(g,{flat:"",dense:"","no-caps":"",class:"bt-link",label:a.tt("login.forgot","¿Olvidaste tu contraseña?"),onClick:a.onForgot},null,8,["label","onClick"])])]),_:1}),t(i,{class:"q-pt-sm"},{default:o(()=>[t(g,{class:"bt-btn full-width",label:a.tt("login.submit","Sign in"),color:"dark",rounded:"",size:"md","no-caps":"",type:"submit",loading:s.loading},null,8,["label","loading"])]),_:1}),t(i,{class:"text-center q-pt-none"},{default:o(()=>[...e[5]||(e[5]=[m("div",{class:"text-grey-7"},[Q(" Don't have an account yet? "),m("a",{href:"#",class:"bt-link-strong"},[m("span",{class:"text-red-9"},"Signup.")])],-1)])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})}const T=w(F,[["render",N],["__scopeId","data-v-2d407998"]]);export{T as default};
